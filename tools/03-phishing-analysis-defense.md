# 3. ðŸŽ£ Phishing Analysis & Defense

Phishing remains one of the most common attack vectors. Blue Teams are constantly analyzing suspicious emails, URLs, and attachments to identify threats, understand attacker techniques, protect users, and improve defenses. This section covers tools and resources used for dissecting phishing attempts and bolstering defenses against them.

## Index of Tools in this Section

* [Any.Run](#anyrun)
* [Browserling](#browserling)
* [Email Header Analysis](#email-header-analysis)
* [GoPhish](#gophish)
* [PhishTank](#phishtank)
* [urlscan.io](#urlscanio)
* [VirusTotal](#virustotal)

---

## Any.Run

* **Description:** An interactive online sandbox service that allows security researchers to detonate malware (including attachments from phishing emails) and analyze suspicious URLs in a safe, controlled cloud environment. It provides detailed process monitoring, network traffic capture, and screenshots/video of the execution.
* **Key Features/Why it's useful:**
    * Safely executing potentially malicious files or opening suspicious links.
    * Observing real-time behavior of malware or malicious websites.
    * Analyzing network traffic generated by the sample (C2 communication, downloads).
    * Viewing process trees, file modifications, and registry changes.
    * Interactive mode allows clicking through installers or websites during analysis.
* **Official Website/Repository:** [https://any.run/](https://any.run/)
* **Type:** Online Sandbox (Freemium Service)
* **Platform(s):** Web (Browser access)
* **Installation:** N/A
* **Basic Usage Example:** Upload a suspicious file or submit a URL via the web interface. Observe the analysis results and interact if needed.
* **Alternatives:** Hybrid Analysis, Joe Sandbox (Commercial), CAPE Sandbox (Open Source), Local VMs.
* **Notes/Tips:** Free tier has limitations (e.g., public submissions). Be mindful of submitting sensitive data. Excellent for dynamic analysis of unknown threats found in phishing emails.

---

## Browserling

* **Description:** An online cross-browser testing service. While designed for web developers, Blue Teams can use Browserling to safely render suspicious URLs in various browser versions and operating systems within a sandboxed environment directly in their own browser, without risk to their local machine.
* **Key Features/Why it's useful:**
    * Safely opening potentially malicious links without infecting your own system.
    * Seeing how a phishing page renders in different browsers (attackers sometimes target specific browsers).
    * Testing link behavior without exposing your real IP address or browser fingerprint directly.
* **Official Website/Repository:** [https://www.browserling.com/](https://www.browserling.com/)
* **Type:** Online Browser Sandbox / Cross-Browser Testing Tool (Freemium Service)
* **Platform(s):** Web (Browser access)
* **Installation:** N/A
* **Basic Usage Example:** Visit the website, paste the suspicious URL, choose a browser/OS combination, and start a test session. Interact with the remote browser safely.
* **Alternatives:** urlscan.io (more focused on scanning than interaction), dedicated sandboxes (Any.Run, etc.), local VMs with browsers.
* **Notes/Tips:** Free tier offers limited session times. Useful for a quick, safe look at a suspicious webpage's appearance and basic functionality.

---

## Email Header Analysis

* **Description:** Not a single tool, but a critical technique for investigating suspicious emails. Analyzing email headers reveals the path the email took across mail servers, the sending IP address, authentication results (SPF, DKIM, DMARC), and potentially signs of spoofing or manipulation.
* **Key Features/Why it's useful:**
    * Identifying the true origin (sending IP) of an email.
    * Verifying email authentication results (SPF, DKIM, DMARC passes/fails indicate legitimacy or potential spoofing).
    * Tracing the email's delivery path through `Received:` headers.
    * Detecting anomalies or inconsistencies that might indicate phishing or spam.
* **Official Website/Repository:** N/A (Technique). Online Analyzers: [MXToolbox Email Header Analyzer](https://mxtoolbox.com/EmailHeaders.aspx), [Google Admin Toolbox Messageheader](https://toolbox.googleapps.com/apps/messageheader/).
* **Type:** Technique / Online Analysis Tools
* **Platform(s):** N/A (Performed using email client's "View Source" or "Show Original" feature + online tools).
* **Installation:** N/A
* **Basic Usage Example:**
    1.  Open the suspicious email in your email client.
    2.  Find the option to view the full headers/original source (e.g., "Show original" in Gmail, "View > Message > All Headers" in Outlook).
    3.  Copy the entire header block.
    4.  Paste it into an online header analyzer (like MXToolbox) or manually inspect the `Received:` lines (read from bottom to top) and `Authentication-Results:` header.
* **Alternatives:** Manual inspection, custom scripts for parsing headers.
* **Notes/Tips:** Understanding SPF, DKIM, and DMARC is crucial for interpreting authentication results. The originating IP found in the first `Received:` header (read bottom-up) is often the most important piece of information for threat intelligence lookups.

---

## GoPhish

* **Description:** An open-source phishing framework. While primarily designed for setting up and launching phishing campaigns, Blue Teams and Security Awareness teams use GoPhish internally for **running controlled phishing simulation exercises** to train users and measure their awareness levels, which is a defensive function.
* **Key Features/Why it's useful (for Blue Team/Training):**
    * Creating realistic phishing email templates and landing pages for internal training.
    * Launching simulated phishing campaigns against employees.
    * Tracking metrics like who opened emails, clicked links, or submitted credentials (in the simulation).
    * Assessing the effectiveness of security awareness training.
* **Official Website/Repository:** [https://getgophish.com/](https://getgophish.com/), [https://github.com/gophish/gophish](https://github.com/gophish/gophish)
* **Type:** Phishing Simulation Framework (Web UI)
* **Platform(s):** Linux, Windows, macOS (distributed as binaries).
* **Installation:** Download release binary, configure `config.json`, run the executable.
* **Basic Usage Example:** Accessed via web interface. Involves setting up user groups, email templates, landing pages, sending profiles (SMTP), and launching campaigns. Requires careful setup and ethical considerations even for internal use.
* **Alternatives:** Commercial Security Awareness Training platforms (KnowBe4, Proofpoint/Wombat, Cofense), other open-source simulators (phishing-frenzy).
* **Notes/Tips:** **Must only be used ethically for internal training with proper authorization.** Useful for demonstrating phishing risks and improving user resilience.

---

## PhishTank

* **Description:** A collaborative clearing house for data and information about phishing on the Internet. Users submit suspected phishing URLs, the community votes on whether they are phishing, and verified phishing URLs are made available via an API or searchable database.
* **Key Features/Why it's useful:**
    * Checking if a suspicious URL has already been identified and verified as a phishing site by the community.
    * Accessing a feed of known active phishing URLs for threat intelligence or blocking purposes.
    * Contributing to the community by submitting new phishing URLs found.
* **Official Website/Repository:** [https://phishtank.org/](https://phishtank.org/)
* **Type:** Community Phishing Database / Threat Intelligence Feed
* **Platform(s):** Web (Browser access), API access available.
* **Installation:** N/A
* **Basic Usage Example:** Visit the website, search for a suspicious URL to see if it's listed. Use the API (requires registration/API key) to integrate the feed into security tools.
* **Alternatives:** OpenPhish (similar feed), Google Safe Browse API, commercial threat intelligence feeds.
* **Notes/Tips:** Community verification means there might be a delay between submission and verification. Useful as one data point among others when analyzing a suspicious URL.

---

## urlscan.io

* **Description:** A free online service and tool that analyzes websites and the resources they request. When a URL is submitted, urlscan.io browses the page like a regular user, records the activity (IPs contacted, domains requested, resources downloaded, technologies used), and takes a screenshot, providing a detailed report for security analysis.
* **Key Features/Why it's useful:**
    * Safely "visiting" a suspicious URL without exposing your own browser/IP.
    * Identifying where a URL redirects.
    * Seeing domains and IPs contacted by the page (useful for finding malicious infrastructure).
    * Detecting suspicious indicators (e.g., brand impersonation, non-standard ports, known malicious IPs).
    * Viewing the page's DOM content and screenshot.
* **Official Website/Repository:** [https://urlscan.io/](https://urlscan.io/)
* **Type:** Online URL Scanner / Website Analysis Tool (Freemium Service)
* **Platform(s):** Web (Browser access), API available.
* **Installation:** N/A
* **Basic Usage Example:** Visit the website, enter the suspicious URL, and review the generated report, paying attention to contacted IPs/domains, redirects, and the screenshot.
* **Alternatives:** Browserling, Any.Run (can scan URLs), VirusTotal (URL scanning), Joe Sandbox (URL analysis).
* **Notes/Tips:** Free scans are public by default unless you have a paid account. Excellent tool for quickly assessing the nature and behavior of a suspicious link found in emails or messages.

---

## VirusTotal

* **Description:** A widely used free online service owned by Google that analyzes files and URLs for viruses, worms, trojans, and other kinds of malicious content using over 70 antivirus scanners and URL/domain blacklisting services.
* **Key Features/Why it's useful:**
    * Quickly checking files (e.g., email attachments) or URLs against a large number of antivirus engines and blocklists.
    * Getting results from multiple vendors simultaneously.
    * Viewing relationships between files, URLs, domains, and IPs based on community intelligence.
    * Accessing behavioral analysis information for some file types.
* **Official Website/Repository:** [https://www.virustotal.com/](https://www.virustotal.com/)
* **Type:** Online File/URL Scanner / Threat Intelligence Aggregator (Freemium Service)
* **Platform(s):** Web (Browser access), API available.
* **Installation:** N/A
* **Basic Usage Example:** Visit the website. Upload a suspicious file or paste a suspicious URL into the search box. Review the detection ratios and detailed results from different engines.
* **Alternatives:** Hybrid Analysis, MetaDefender Cloud, Joe Sandbox.
* **Notes/Tips:** A "clean" result doesn't guarantee safety (especially for zero-day threats), but a high detection rate is a strong indicator of malice. Be cautious about uploading sensitive files. The "Relations" and "Behavior" tabs provide valuable context.

---